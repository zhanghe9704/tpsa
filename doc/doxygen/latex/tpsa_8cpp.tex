\hypertarget{tpsa_8cpp}{}\doxysection{E\+:/\+Work/\+Code/tpsa\+\_\+lib/src/tpsa.cpp File Reference}
\label{tpsa_8cpp}\index{E:/Work/Code/tpsa\_lib/src/tpsa.cpp@{E:/Work/Code/tpsa\_lib/src/tpsa.cpp}}


Automatic Differentiation Test.  


{\ttfamily \#include $<$iostream$>$}\newline
{\ttfamily \#include $<$ctime$>$}\newline
{\ttfamily \#include $<$vector$>$}\newline
{\ttfamily \#include $<$algorithm$>$}\newline
{\ttfamily \#include $<$cmath$>$}\newline
{\ttfamily \#include $<$cstdlib$>$}\newline
{\ttfamily \#include \char`\"{}../include/tpsa.\+h\char`\"{}}\newline
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{tpsa_8cpp_aa473b1ce438a2216ea80d5a4adc9e72e}{ad\+\_\+init}} (const \mbox{\hyperlink{tpsa_8h_a015d1e5f2a6fc8bd756badae78e77360}{TNVND}} $\ast$nvar, const \mbox{\hyperlink{tpsa_8h_a015d1e5f2a6fc8bd756badae78e77360}{TNVND}} $\ast$nord)
\begin{DoxyCompactList}\small\item\em Initialize the TPSA library. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{tpsa_8cpp_affcc4435bf98e9522c608a70773e6dab}\label{tpsa_8cpp_affcc4435bf98e9522c608a70773e6dab}} 
void \mbox{\hyperlink{tpsa_8cpp_affcc4435bf98e9522c608a70773e6dab}{ad\+\_\+resetvars}} (const \mbox{\hyperlink{tpsa_8h_a015d1e5f2a6fc8bd756badae78e77360}{TNVND}} $\ast$nvar)
\begin{DoxyCompactList}\small\item\em Reset the base vectors. To avoid confusions when starting a new set of TPSA calculations, call this before a new \mbox{\hyperlink{tpsa_8cpp_aa473b1ce438a2216ea80d5a4adc9e72e}{ad\+\_\+init()}}. with nv from ad\+\_\+nvar(nv). \end{DoxyCompactList}\item 
void \mbox{\hyperlink{tpsa_8cpp_ab76aa1315af4aa53b8157ec5508d2277}{ad\+\_\+count}} (TVEC $\ast$n)
\begin{DoxyCompactList}\small\item\em $\ast$$\ast$ \end{DoxyCompactList}\item 
\mbox{\Hypertarget{tpsa_8cpp_a25f41349ba7f4f74da692834349ecf3b}\label{tpsa_8cpp_a25f41349ba7f4f74da692834349ecf3b}} 
void \mbox{\hyperlink{tpsa_8cpp_a25f41349ba7f4f74da692834349ecf3b}{ad\+\_\+const}} (const TVEC $\ast$iv, const double $\ast$r)
\begin{DoxyCompactList}\small\item\em Set a TPS vector as a constant. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{tpsa_8cpp_a14d7813be2e2ec86a5bd1a6c8f8210c3}\label{tpsa_8cpp_a14d7813be2e2ec86a5bd1a6c8f8210c3}} 
void \mbox{\hyperlink{tpsa_8cpp_a14d7813be2e2ec86a5bd1a6c8f8210c3}{ad\+\_\+clean}} (const TVEC $\ast$iv, const double $\ast$eps)
\begin{DoxyCompactList}\small\item\em Set the small TPS coefficients as 0 if they are less than eps. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{tpsa_8cpp_a5ee339f01a2eccb987ca8f3c2f884b79}{ad\+\_\+fill\+\_\+ran}} (const TVEC $\ast$iv, const double $\ast$ratio, const double $\ast$xm)
\begin{DoxyCompactList}\small\item\em Fill the TPS coefficients as a random number in \mbox{[}0,1\mbox{]}. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{tpsa_8cpp_a83e8fdc025815705a2d84bdb52db0e9f}\label{tpsa_8cpp_a83e8fdc025815705a2d84bdb52db0e9f}} 
void {\bfseries ad\+\_\+pok} (const unsigned int $\ast$ivec, int $\ast$c, size\+\_\+t $\ast$n, double $\ast$x)
\item 
\mbox{\Hypertarget{tpsa_8cpp_af8f699e5ad097f081829e9f9b695ad05}\label{tpsa_8cpp_af8f699e5ad097f081829e9f9b695ad05}} 
void {\bfseries ad\+\_\+elem} (const TVEC $\ast$ivec, unsigned int $\ast$idx, unsigned int $\ast$c, double $\ast$x)
\item 
\mbox{\Hypertarget{tpsa_8cpp_af697f1b707481b6f71b27cb79fd28387}\label{tpsa_8cpp_af697f1b707481b6f71b27cb79fd28387}} 
void {\bfseries ad\+\_\+pek} (const unsigned int $\ast$ivec, int $\ast$c, size\+\_\+t $\ast$n, double $\ast$x)
\item 
\mbox{\Hypertarget{tpsa_8cpp_a9f95d27cf468b3e830a79961d836ded5}\label{tpsa_8cpp_a9f95d27cf468b3e830a79961d836ded5}} 
void {\bfseries ad\+\_\+var} (const unsigned int $\ast$ivec, const double $\ast$x, unsigned int $\ast$ibvec)
\item 
\mbox{\Hypertarget{tpsa_8cpp_a706f781fd098cc1056f130391a929c86}\label{tpsa_8cpp_a706f781fd098cc1056f130391a929c86}} 
void {\bfseries ad\+\_\+truncate} (const TVEC $\ast$iv, const \mbox{\hyperlink{tpsa_8h_a015d1e5f2a6fc8bd756badae78e77360}{TNVND}} $\ast$d)
\item 
\mbox{\Hypertarget{tpsa_8cpp_a7c3ef17c5d4bb1b73f6a840ce99f2041}\label{tpsa_8cpp_a7c3ef17c5d4bb1b73f6a840ce99f2041}} 
void {\bfseries ad\+\_\+add} (const unsigned int $\ast$idst, const unsigned int $\ast$jsrc)
\item 
\mbox{\Hypertarget{tpsa_8cpp_af81d709d685093427012234701ba2bb0}\label{tpsa_8cpp_af81d709d685093427012234701ba2bb0}} 
void {\bfseries ad\+\_\+add\+\_\+const} (const TVEC $\ast$i, double $\ast$r)
\item 
\mbox{\Hypertarget{tpsa_8cpp_aec7b7b9c831fec8cb8f5396ac194f880}\label{tpsa_8cpp_aec7b7b9c831fec8cb8f5396ac194f880}} 
void {\bfseries ad\+\_\+sub} (const unsigned int $\ast$idst, const unsigned int $\ast$jsrc)
\item 
\mbox{\Hypertarget{tpsa_8cpp_ad563dbfc25b1018ac6c8e3bb1b0ab5ae}\label{tpsa_8cpp_ad563dbfc25b1018ac6c8e3bb1b0ab5ae}} 
void \mbox{\hyperlink{tpsa_8cpp_ad563dbfc25b1018ac6c8e3bb1b0ab5ae}{ad\+\_\+mult\+\_\+const}} (const TVEC $\ast$iv, double $\ast$c)
\begin{DoxyCompactList}\small\item\em internal multiplication, dst should be different from lhs and rhs. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{tpsa_8cpp_a7b3c8f7e505c46d491d15981741208f7}\label{tpsa_8cpp_a7b3c8f7e505c46d491d15981741208f7}} 
void {\bfseries ad\+\_\+div} (const TVEC $\ast$ilhs, const TVEC $\ast$irhs, TVEC $\ast$idst)
\item 
\mbox{\Hypertarget{tpsa_8cpp_a5598b044c58daedbc67674fb19f08616}\label{tpsa_8cpp_a5598b044c58daedbc67674fb19f08616}} 
void {\bfseries ad\+\_\+sqrt} (const TVEC $\ast$iv, const TVEC $\ast$iret)
\item 
\mbox{\Hypertarget{tpsa_8cpp_ab1dc42612ace8601f9c361b622f1528a}\label{tpsa_8cpp_ab1dc42612ace8601f9c361b622f1528a}} 
void {\bfseries ad\+\_\+exp} (const TVEC $\ast$iv, const TVEC $\ast$iret)
\item 
\mbox{\Hypertarget{tpsa_8cpp_a02ee3f5882a69c521c23a157323a6d7b}\label{tpsa_8cpp_a02ee3f5882a69c521c23a157323a6d7b}} 
void {\bfseries ad\+\_\+log} (const TVEC $\ast$iv, const TVEC $\ast$iret)
\item 
void \mbox{\hyperlink{tpsa_8cpp_a9bfad92601b7c4c81bb14e51e0016672}{ad\+\_\+sin}} (const TVEC $\ast$iv, const TVEC $\ast$iret)
\begin{DoxyCompactList}\small\item\em $\ast$$\ast$ \end{DoxyCompactList}\item 
\mbox{\Hypertarget{tpsa_8cpp_a7127c7553acec12be8d4f9d6e39bfa4b}\label{tpsa_8cpp_a7127c7553acec12be8d4f9d6e39bfa4b}} 
void {\bfseries ad\+\_\+cos} (const TVEC $\ast$iv, const TVEC $\ast$iret)
\item 
\mbox{\Hypertarget{tpsa_8cpp_af61048119f09f7cd849d4b985eac44b8}\label{tpsa_8cpp_af61048119f09f7cd849d4b985eac44b8}} 
void {\bfseries ad\+\_\+derivative} (const TVEC $\ast$iv, unsigned int $\ast$expo, const TVEC $\ast$iret)
\item 
\mbox{\Hypertarget{tpsa_8cpp_ac54d6dd59ba6d00ab5a802cae7e95cb7}\label{tpsa_8cpp_ac54d6dd59ba6d00ab5a802cae7e95cb7}} 
void \mbox{\hyperlink{tpsa_8cpp_ac54d6dd59ba6d00ab5a802cae7e95cb7}{ad\+\_\+tra}} (const TVEC $\ast$iv, unsigned int $\ast$expo, const TVEC $\ast$iret)
\begin{DoxyCompactList}\small\item\em similar to ad\+\_\+derivative, but doesn\textquotesingle{}t multiply the exponent part of x\+\_\+\{expo\} \end{DoxyCompactList}\item 
\mbox{\Hypertarget{tpsa_8cpp_ae0c407dd096f879f49d4cd721dd07f25}\label{tpsa_8cpp_ae0c407dd096f879f49d4cd721dd07f25}} 
void {\bfseries ad\+\_\+shift} (const TVEC $\ast$iv, unsigned int $\ast$ishift, const TVEC $\ast$iret, const double $\ast$eps)
\item 
\mbox{\Hypertarget{tpsa_8cpp_aa8ed335e25f9d0589f41e917ea800b59}\label{tpsa_8cpp_aa8ed335e25f9d0589f41e917ea800b59}} 
void {\bfseries ad\+\_\+subst} (const TVEC $\ast$iv, const TVEC $\ast$ibv, const \mbox{\hyperlink{tpsa_8h_a015d1e5f2a6fc8bd756badae78e77360}{TNVND}} $\ast$nbv, const TVEC $\ast$iret)
\item 
\mbox{\Hypertarget{tpsa_8cpp_aea6f5f202219d5b79e5c8faefe6f90ec}\label{tpsa_8cpp_aea6f5f202219d5b79e5c8faefe6f90ec}} 
void {\bfseries ad\+\_\+inverse} (const TVEC $\ast$iva, const \mbox{\hyperlink{tpsa_8h_a015d1e5f2a6fc8bd756badae78e77360}{TNVND}} $\ast$nva, const TVEC $\ast$iret, const \mbox{\hyperlink{tpsa_8h_a015d1e5f2a6fc8bd756badae78e77360}{TNVND}} $\ast$nret)
\item 
\mbox{\Hypertarget{tpsa_8cpp_ab11b24a982c3aaa2b042f853405c067c}\label{tpsa_8cpp_ab11b24a982c3aaa2b042f853405c067c}} 
void {\bfseries ad\+\_\+nvar} (TVEC $\ast$n)
\item 
\mbox{\Hypertarget{tpsa_8cpp_a11405ea05594227a12ae3e79b6b43e8c}\label{tpsa_8cpp_a11405ea05594227a12ae3e79b6b43e8c}} 
void {\bfseries ad\+\_\+length} (const TVEC $\ast$iv, unsigned int $\ast$n)
\item 
\mbox{\Hypertarget{tpsa_8cpp_a09aa102513f3273ca4b7a3cb62bdd66e}\label{tpsa_8cpp_a09aa102513f3273ca4b7a3cb62bdd66e}} 
void {\bfseries ad\+\_\+read\+\_\+block} (const TVEC $\ast$iv, double $\ast$v, \mbox{\hyperlink{tpsa_8h_a015d1e5f2a6fc8bd756badae78e77360}{TNVND}} $\ast$J, const unsigned int $\ast$N)
\item 
\mbox{\Hypertarget{tpsa_8cpp_aca7a526b73aeeced3288a61f655171a2}\label{tpsa_8cpp_aca7a526b73aeeced3288a61f655171a2}} 
void \mbox{\hyperlink{tpsa_8cpp_aca7a526b73aeeced3288a61f655171a2}{ad\+\_\+save\+\_\+block}} (const TVEC $\ast$iv, const double $\ast$v, const \mbox{\hyperlink{tpsa_8h_a015d1e5f2a6fc8bd756badae78e77360}{TNVND}} $\ast$J, const unsigned int $\ast$N)
\begin{DoxyCompactList}\small\item\em blind set, assuming order of J is right. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{tpsa_8cpp_ad087b206b0ec782659ee6390d5c0b9f2}\label{tpsa_8cpp_ad087b206b0ec782659ee6390d5c0b9f2}} 
void \mbox{\hyperlink{tpsa_8cpp_ad087b206b0ec782659ee6390d5c0b9f2}{print\+\_\+index}} (std\+::ostream \&os)
\begin{DoxyCompactList}\small\item\em Print out ad vector represented by i. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{tpsa_8cpp_ad7989f64a5c9337fb8daeb734411c758}\label{tpsa_8cpp_ad7989f64a5c9337fb8daeb734411c758}} 
void {\bfseries ad\+\_\+print} (const unsigned int $\ast$iv)
\item 
\mbox{\Hypertarget{tpsa_8cpp_a94b265d49d389555d2e333032715eaa2}\label{tpsa_8cpp_a94b265d49d389555d2e333032715eaa2}} 
void {\bfseries ad\+\_\+print\+\_\+array} (const TVEC $\ast$iv, const TVEC $\ast$nv)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{tpsa_8cpp_a09082190e4974e986e38201985c36e90}\label{tpsa_8cpp_a09082190e4974e986e38201985c36e90}} 
std\+::vector$<$ double $\ast$ $>$ {\bfseries advec}
\item 
\mbox{\Hypertarget{tpsa_8cpp_a0168b7d485c55fc8b23a3fe9473dcb42}\label{tpsa_8cpp_a0168b7d485c55fc8b23a3fe9473dcb42}} 
std\+::vector$<$ unsigned int $>$ {\bfseries adveclen}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Automatic Differentiation Test. 

\begin{DoxyVersion}{Version}

\end{DoxyVersion}
\begin{DoxyParagraph}{Id}
\mbox{\hyperlink{tpsa_8cpp}{tpsa.\+cpp}},v 1.\+4 2009-\/06-\/08 10\+:48\+:43 frs Exp 
\end{DoxyParagraph}
\begin{DoxyAuthor}{Author}
Lingyun Yang, \href{http://www.lingyunyang.com/}{\texttt{ http\+://www.\+lingyunyang.\+com/}} 
\end{DoxyAuthor}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{tpsa_8cpp_ab76aa1315af4aa53b8157ec5508d2277}\label{tpsa_8cpp_ab76aa1315af4aa53b8157ec5508d2277}} 
\index{tpsa.cpp@{tpsa.cpp}!ad\_count@{ad\_count}}
\index{ad\_count@{ad\_count}!tpsa.cpp@{tpsa.cpp}}
\doxysubsubsection{\texorpdfstring{ad\_count()}{ad\_count()}}
{\footnotesize\ttfamily void ad\+\_\+count (\begin{DoxyParamCaption}\item[{TVEC $\ast$}]{n }\end{DoxyParamCaption})}



$\ast$$\ast$ 

Allocate space for one TPS vector. $\ast$$\ast$ Copy TPS vector

Count how many vectors has been allocated \mbox{\Hypertarget{tpsa_8cpp_a5ee339f01a2eccb987ca8f3c2f884b79}\label{tpsa_8cpp_a5ee339f01a2eccb987ca8f3c2f884b79}} 
\index{tpsa.cpp@{tpsa.cpp}!ad\_fill\_ran@{ad\_fill\_ran}}
\index{ad\_fill\_ran@{ad\_fill\_ran}!tpsa.cpp@{tpsa.cpp}}
\doxysubsubsection{\texorpdfstring{ad\_fill\_ran()}{ad\_fill\_ran()}}
{\footnotesize\ttfamily void ad\+\_\+fill\+\_\+ran (\begin{DoxyParamCaption}\item[{const TVEC $\ast$}]{iv,  }\item[{const double $\ast$}]{ratio,  }\item[{const double $\ast$}]{xm }\end{DoxyParamCaption})}



Fill the TPS coefficients as a random number in \mbox{[}0,1\mbox{]}. 

The length(highest nonzero coefficients) is not changed. \mbox{\Hypertarget{tpsa_8cpp_aa473b1ce438a2216ea80d5a4adc9e72e}\label{tpsa_8cpp_aa473b1ce438a2216ea80d5a4adc9e72e}} 
\index{tpsa.cpp@{tpsa.cpp}!ad\_init@{ad\_init}}
\index{ad\_init@{ad\_init}!tpsa.cpp@{tpsa.cpp}}
\doxysubsubsection{\texorpdfstring{ad\_init()}{ad\_init()}}
{\footnotesize\ttfamily void ad\+\_\+init (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{tpsa_8h_a015d1e5f2a6fc8bd756badae78e77360}{TNVND}} $\ast$}]{nvar,  }\item[{const \mbox{\hyperlink{tpsa_8h_a015d1e5f2a6fc8bd756badae78e77360}{TNVND}} $\ast$}]{nord }\end{DoxyParamCaption})}



Initialize the TPSA library. 


\begin{DoxyParams}{Parameters}
{\em nvar} & number of variables \\
\hline
{\em nord} & highest order of TPS.\\
\hline
\end{DoxyParams}
This must be called before any use of TPS vector, and followed by ad\+\_\+reserve \mbox{\Hypertarget{tpsa_8cpp_a9bfad92601b7c4c81bb14e51e0016672}\label{tpsa_8cpp_a9bfad92601b7c4c81bb14e51e0016672}} 
\index{tpsa.cpp@{tpsa.cpp}!ad\_sin@{ad\_sin}}
\index{ad\_sin@{ad\_sin}!tpsa.cpp@{tpsa.cpp}}
\doxysubsubsection{\texorpdfstring{ad\_sin()}{ad\_sin()}}
{\footnotesize\ttfamily void ad\+\_\+sin (\begin{DoxyParamCaption}\item[{const TVEC $\ast$}]{iv,  }\item[{const TVEC $\ast$}]{iret }\end{DoxyParamCaption})}



$\ast$$\ast$ 

Reset to a constant 0 